<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Functions for manipulation of R documentation objects,
    including functions reprompt() and ereprompt() for updating Rd
    documentation for functions, methods and classes; Rd macros for
    citations and import of references from bibtex files for use in
    Rd files and roxygen2 comments; Rd macros for evaluating and
    inserting snippets of R code and the results of its evaluation or
    creating graphics on the fly; and many functions for manipulation of
    references and Rd files.">
<title>Update and Manipulate Rd Documentation Objects • Rdpack</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Update and Manipulate Rd Documentation Objects">
<meta property="og:description" content="Functions for manipulation of R documentation objects,
    including functions reprompt() and ereprompt() for updating Rd
    documentation for functions, methods and classes; Rd macros for
    citations and import of references from bibtex files for use in
    Rd files and roxygen2 comments; Rd macros for evaluating and
    inserting snippets of R code and the results of its evaluation or
    creating graphics on the fly; and many functions for manipulation of
    references and Rd files.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">Rdpack</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.4.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/GeoBosh/Rdpack/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<p>Rdpack provides functions for manipulation of R documentation objects, including functions <code><a href="reference/reprompt.html">reprompt()</a></code> and <code><a href="reference/ereprompt.html">ereprompt()</a></code> for updating existing Rd documentation for functions, methods and classes; Rd macros for citations and import of references from <code>bibtex</code> files for use in <code>Rd</code> files and <code>roxygen2</code> comments (<code>\insertRef</code>, <code>\insertCite</code>, <code>\insertAllCited</code>); Rd macros for evaluating and inserting snippets of R code and the results of its evaluation (<code>\printExample</code>) or creating graphics on the fly (<code>\insertFig</code>); and many functions for manipulation of references and Rd files.</p>
<div class="section level1">
<div class="page-header"><h1 id="table-of-contents">Table of Contents<a class="anchor" aria-label="anchor" href="#table-of-contents"></a>
</h1></div>
<ol style="list-style-type: decimal">
<li><a href="#org8a647c9">Installing Rdpack</a></li>
<li>
<a href="#org4e77937">Inserting Bibtex references and citations</a><ol style="list-style-type: decimal">
<li><a href="#org766760b">Preparation</a></li>
<li><a href="#orgf0b8e07">Inserting references</a></li>
<li><a href="#orgbff7de3">Inserting citations</a></li>
<li><a href="#orge63a829">Changing the style of references</a></li>
<li>
<a href="#org35439dc">Troubleshooting</a><ol style="list-style-type: decimal">
<li><a href="#orgc0ddf98">A puzzling message in devtools development mode</a></li>
<li><a href="#orge94900c">Typical errors</a></li>
</ol>
</li>
<li><a href="#org7490870">Latex markup in BibTeX entries</a></li>
<li><a href="#org5fd3efd">Encoding of file REFERENCES.bib</a></li>
</ol>
</li>
<li><a href="#orgb41e139">Viewing Rd files</a></li>
<li>
<a href="#orgcdf91db">Using Rdpack::reprompt()</a><ol style="list-style-type: decimal">
<li><a href="#orge44c86a">What it does</a></li>
<li><a href="#org975854d">Reprompt and open in an editor</a></li>
</ol>
</li>
<li>
<a href="#orgb77362a">Inserting evaluated examples</a><ol style="list-style-type: decimal"><li><a href="#org3bee793">Evaluating the examples in section Examples</a></li></ol>
</li>
<li><a href="#org9b84bd5">Inserting figures/graphs/plots</a></li>
</ol>
<p><a id="org8a647c9"></a></p>
</div>
<div class="section level1">
<h1 id="installing-rdpack">Installing Rdpack<a class="anchor" aria-label="anchor" href="#installing-rdpack"></a>
</h1>
<p>Install the <a href="https://cran.r-project.org/package=Rdpack" class="external-link">latest stable version</a> from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">install.packages</span>(<span class="st">"Rdpack"</span>)</span></code></pre></div>
<p>You can also install the <a href="https://github.com/GeoBosh/Rdpack" class="external-link">development version</a> of <code>Rdpack</code> from Github:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(devtools)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">install_github</span>(<span class="st">"GeoBosh/Rdpack"</span>)</span></code></pre></div>
<p><a id="org4e77937"></a></p>
</div>
<div class="section level1">
<h1 id="inserting-bibtex-references-and-citations">Inserting Bibtex references and citations<a class="anchor" aria-label="anchor" href="#inserting-bibtex-references-and-citations"></a>
</h1>
<p>The simplest way to insert Bibtex references is with the Rd macro <code>\insertRef</code>. Just put <code>\insertRef{key}{package}</code> in the documentation to insert item with key <code>key</code> from file <code>REFERENCES.bib</code> in your package <code>package</code>. Alternatively, use one or more <code>\insertCite{key}{package}</code> commands to cite works from <code>REFERENCES.bib</code>, then issue a single <code>\insertAllCited{}</code> directive to produce a list of all cited references. For this to work the <code>DESCRIPTION</code> file of the package needs to be amended, see below the full details.</p>
<p><a id="org766760b"></a></p>
<div class="section level2">
<h2 id="preparation">Preparation<a class="anchor" aria-label="anchor" href="#preparation"></a>
</h2>
<p>To prepare a package for importing BibTeX references it is necessary to tell the package management tools that package Rdpack and its Rd macros are needed. The references should be put in file <code>inst/REFERENCES.bib</code>. These steps are enumerated below in somewhat more detail, see also the vignette <a href="https://cran.r-project.org/package=Rdpack" class="external-link"><code>Inserting_bibtex_references</code></a>.</p>
<ol style="list-style-type: decimal">
<li>
<p>Add the following lines to file “DESCRIPTION”:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>Imports<span class="op">:</span><span class="st"> </span>Rdpack</span>
<span id="cb3-2"><a href="#cb3-2"></a>RdMacros<span class="op">:</span><span class="st"> </span>Rdpack</span></code></pre></div>
<p>Make sure the capitalisation of <code>RdMacros:</code> is as shown. If the field <code>RdMacros:</code> is already present, add “Rdpack” to the list on that line. Similarly for field “Imports:”.</p>
</li>
<li>
<p>Add the following line to file “NAMESPACE”:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">importFrom</span>(Rdpack,reprompt)</span></code></pre></div>
<p>The equivalent line for <code>roxygen2</code> is</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">#' @importFrom Rdpack reprompt</span></span></code></pre></div>
</li>
<li><p>Create file <code>REFERENCES.bib</code> in subdirectory <code>inst/</code> of your package and put the BibTeX references in it.</p></li>
</ol>
<p><a id="orgf0b8e07"></a></p>
</div>
<div class="section level2">
<h2 id="inserting-references">Inserting references<a class="anchor" aria-label="anchor" href="#inserting-references"></a>
</h2>
<p>Once the steps outlined above are done, references can be inserted in the documentation as</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>\insertRef{key}{package}</span></code></pre></div>
<p>where <code>key</code> is the bibtex key of the reference and <code>package</code> is your package. This works in <code>Rd</code> files and in <code>roxygen</code> documentation chunks.</p>
<p>Usually references are put in section <code>references</code>. In an <code>Rd</code> file this might look something like:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>\references{</span>
<span id="cb7-2"><a href="#cb7-2"></a>\insertRef{Rdpack<span class="op">:</span>bibtex}{Rdpack}</span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a>\insertRef{R}{bibtex}</span>
<span id="cb7-5"><a href="#cb7-5"></a>}</span></code></pre></div>
<p>The equivalent <code>roxygen2</code> documentation chunk would be:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co">#' @references</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co">#' \insertRef{Rpackage:rbibutils}{Rdpack}</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co">#'</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">#' \insertRef{R}{bibtex}</span></span></code></pre></div>
<p>The first line above inserts the reference with key <code>Rpackage:rbibutils</code> in Rdpack’s REFERENCES.bib. The second line inserts the reference labeled <code>R</code> in file REFERENCES.bib from package <code>bibtex</code>.</p>
<p>The example above demonstrates that references from other packages can be inserted (in this case <code>bibtex</code>), as well. This is strongly discouraged for released versions but is convenient during development. One relatively safe use is when the other package is also yours - this allows authors of multiple packages to not copy the same refences to each of their own packages.</p>
<p>For further details see the vignette <a href="https://cran.r-project.org/package=Rdpack" class="external-link"><code>Inserting_bibtex_references</code></a> or open it from <code>R</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">vignette</span>(<span class="st">"Inserting_bibtex_references"</span>, <span class="dt">package =</span> <span class="st">"Rdpack"</span>)</span></code></pre></div>
<p>(The latest version of the vignette is at <a href="https://github.com/GeoBosh/Rdpack/blob/master/vignettes/Inserting_bibtex_references.pdf" class="external-link"><code>Inserting_bibtex_references (development version on github)</code></a>.)</p>
<p><a id="orgbff7de3"></a></p>
</div>
<div class="section level2">
<h2 id="inserting-citations">Inserting citations<a class="anchor" aria-label="anchor" href="#inserting-citations"></a>
</h2>
<p>Additional Rd macros are available for citations. They also can be used in both Rd and roxygen2 documentation.</p>
<p><code>\insertCite{key}{package}</code> cites <code>key</code> and records it for use by <code>\insertAllCited</code> and <code>\insertCited</code>, see below. <code>key</code> can contain more keys separated by commas.</p>
<p><code>\insertCite{parseRd,Rpackage:rbibutils}{Rdpack}</code> produces (Murdoch 2010; Boshnakov and Putman 2020) and <code>\insertCite{Rpackage:rbibutils}{Rdpack}</code> gives (Boshnakov and Putman 2020).</p>
<p>By default the citations are parenthesised: <code>\insertCite{parseRd}{Rdpack}</code> produces (Murdoch 2010). To get textual citations, like Murdoch (2010), put the string <code>;textual</code> at the end of the key. The references in the last two sentences would be produced with <code>\insertCite{parseRd}{Rdpack}</code> and <code>\insertCite{parseRd;textual}{Rdpack}</code>, respectively. This also works with several citations, e.g.</p>
<p><code>\insertCite{parseRd,Rpackage:rbibutils;textual}{Rdpack}</code> produces: Murdoch (2010); Boshnakov and Putman (2020).</p>
<p>The macro <code>\insertNoCite{key}{package}</code> records one or more references for <code>\insertAllCited</code> but does not cite it. Setting <code>key</code> to <code>*</code> will include all references from the specified package. For example, <code>\insertNoCite{R}{bibtex}</code> and <code>\insertNoCite{*}{utils}</code> record the specified references for inclusion by <code>\insertAllCited</code>.</p>
<p><code>\insertAllCited</code> inserts all references cited with <code>\insertCite</code> or <code>\insertNoCite</code>. Putting this macro in the references section will keep it up to date automatically. The Rd section may look something like:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>\insertAllCited{}</span></code></pre></div>
<p>or, in roxygen2, the references chunk might look like this:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co">#' @references</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co">#'   \insertAllCited{}</span></span></code></pre></div>
<p>Don’t align the backslash with the second ‘e’ of <code>@references</code>, since roxygen2 may interpret it as verbatim text, not macro.</p>
<p><code>\insertCited{}</code> works like <code>\insertAllCited</code> but empties the reference list after finishing its work. This means that the second and subsequent <code>\insertCited</code> in the same help page will list only citations done since the preceding <code>\insertCited</code>. Prompted by issue 27 on github to allow separate reference lists for each method and the class in R6 documentation.</p>
<p>To mix the citations with other text, such as ``see also’’ and ``chapter 3’’, write the list of keys as a free text, starting it with the symbol <code>@</code> and prefixing each key with it. The <code>@</code> symbol will not appear in the output. For example, the following code</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>\insertCite{<span class="op">@</span>see also <span class="op">@</span>parseRd and <span class="op">@</span>Rpackage<span class="op">:</span>rbibutils}{Rdpack}</span>
<span id="cb12-2"><a href="#cb12-2"></a>\insertCite{<span class="op">@</span>see also <span class="op">@</span>parseRd; <span class="op">@</span>Rpackage<span class="op">:</span>rbibutils}{Rdpack}</span>
<span id="cb12-3"><a href="#cb12-3"></a>\insertCite{<span class="op">@</span>see also <span class="op">@</span>parseRd and <span class="op">@</span>Rpackage<span class="op">:</span>rbibutils;textual}{Rdpack}</span></code></pre></div>
<p>produces:</p>
<p>(see also Murdoch 2010 and Boshnakov and Putman 2020)</p>
<p>(see also Murdoch 2010; Boshnakov and Putman 2020)</p>
<p>see also Murdoch (2010) and Boshnakov and Putman (2020)</p>
<p>With the parenthesised citations, if you need markup for the text before or after the citations, say <code>see also</code> in italic, put <code>;nobrackets</code><sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup> at the end of the first argument of the Rd macro, take out the part containing markup, and put the parentheses were suitable. For example,</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>(\emph{see also} \insertCite{<span class="op">@</span><span class="er">@</span>parseRd and <span class="op">@</span>Rpackage<span class="op">:</span>rbibutils;nobrackets}{Rdpack})</span></code></pre></div>
<p>(in markdown, use <code>_see also_</code> in place of <code>\emph{see also})</code>. This gives:</p>
<p>(<em>see also</em> Murdoch 2010 and Boshnakov and Putman 2020)</p>
<p>—</p>
<p><code>\insertCiteOnly{key}{package}</code> is as <code>\insertCite</code> but does not include the key in the list of references for <code>\insertAllCited</code>.</p>
<p><a id="orge63a829"></a></p>
</div>
<div class="section level2">
<h2 id="changing-the-style-of-references">Changing the style of references<a class="anchor" aria-label="anchor" href="#changing-the-style-of-references"></a>
</h2>
<p>Bibliography styles for lists of references are supported from <span class="underline">Rdpack (&gt;= 0.8)</span>. Currently the only alternative offered is to use long names (Georgi N. Boshnakov) in place of the default style (Boshnakov GN). More comprehensive alternatives can be included if needed or requested.</p>
<p>To cause all lists of references produced by <code>\insertAllCited</code> in a package to appear with full names, add <code>.onLoad()</code> function to your package. If you don’t have <code>.onLoad()</code>, just copy the following definition:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>.onLoad &lt;-<span class="st"> </span><span class="cf">function</span>(lib, pkg){</span>
<span id="cb14-2"><a href="#cb14-2"></a>    Rdpack<span class="op">::</span><span class="kw">Rdpack_bibstyles</span>(<span class="dt">package =</span> pkg, <span class="dt">authors =</span> <span class="st">"LongNames"</span>)</span>
<span id="cb14-3"><a href="#cb14-3"></a>    <span class="kw">invisible</span>(<span class="ot">NULL</span>)</span>
<span id="cb14-4"><a href="#cb14-4"></a>}</span></code></pre></div>
<p>If you already have <code>.onLoad()</code>, add the line containing the <code><a href="reference/Rdpack_bibstyles.html">Rdpack::Rdpack_bibstyles</a></code> call to it.</p>
<p>After installling/reloading your package the lists of references should appear with long author names. “Rdpack” itself now uses this style.</p>
<p><a id="org35439dc"></a></p>
</div>
<div class="section level2">
<h2 id="troubleshooting">Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting"></a>
</h2>
<p><a id="orgc0ddf98"></a></p>
<div class="section level3">
<h3 id="a-puzzling-message-in-devtools-development-mode">A puzzling message in devtools development mode<a class="anchor" aria-label="anchor" href="#a-puzzling-message-in-devtools-development-mode"></a>
</h3>
<p>The described procedure works transparently in <code>roxygen2</code> chunks and with Hadley Wickham’s package <code>devtools</code>. Packages are built and installed properly with the <code>devtools</code> commands and the references are processed as expected.</p>
<p>Currently (2017-08-04) if you run help commands <code>?xxx</code> for functions from the package you are working on <em>in developement mode</em> and their help pages contain references, you may encounter some puzzling warning messages, something like:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="dv">1</span><span class="op">:</span><span class="st"> </span>In tools<span class="op">::</span><span class="kw">parse_Rd</span>(path) <span class="op">:</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="st">  </span><span class="er">~/</span>mypackage<span class="op">/</span>man<span class="op">/</span>abcde.Rd<span class="op">:</span><span class="st"> </span><span class="dv">67</span><span class="op">:</span><span class="st"> </span>unknown macro <span class="st">'\insertRef'</span></span></code></pre></div>
<p>These warnings are harmless and can be ignored — the help pages are built properly and no warnings appear outside <em>developer’s mode</em>, e.g. in a separate R session<sup><a id="fnr.2" class="footref" href="#fn.2">2</a></sup>. Even better, use the function <code><a href="reference/viewRd.html">viewRd()</a></code> described below to view the required help file.</p>
<p><a id="orge94900c"></a></p>
</div>
<div class="section level3">
<h3 id="typical-errors">Typical errors<a class="anchor" aria-label="anchor" href="#typical-errors"></a>
</h3>
<p>The functions underlying the processing of references and citations intercept errors, such as missing BibTeX labels or badly formed items in REFERENCES.bib, and issue informative warnings during the building and installation of the package, so that the developer is alerted but the package can still be built and installed. In these cases the functions usually insert a suitable text in the documentation, as well. If you encounter a situation contradicting this description, it is probably a bug — please report it (but check first for the typical errors listed below).</p>
<p>A non-decipherable error message is probably caused by one of the following typical errors:</p>
<ul>
<li><p>misspelled <code>RdMacros:</code> field in file DESCRIPTION. The safest way to avoid this is to copy it from the DESCRIPTION file of a working package.</p></li>
<li><p>omitted second argument of a reference or citation macro. Most of these macros have the package name as a second argument.</p></li>
</ul>
<p>These errors occur during parsing of the Rd files, before the control is passed to the <code>Rdpack</code>’s macros.</p>
<p><a id="org7490870"></a></p>
</div>
</div>
<div class="section level2">
<h2 id="latex-markup-in-bibtex-entries">Latex markup in BibTeX entries<a class="anchor" aria-label="anchor" href="#latex-markup-in-bibtex-entries"></a>
</h2>
<p>In principle, BibTeX entries may contain arbitrary Latex markup, while the Rd format supports only a subset. As a consequence, some BibTeX entries may need some editing when included in REFERENCES.bib<sup><a id="fnr.3" class="footref" href="#fn.3">3</a></sup>. Only do this for entries that do not render properly or cause errors, since most of the time this should not be necessary.</p>
<p>If mathematics doesn’t render properly replace the Latex dollar syntax with Rd’s <code>\eqn</code>, e.g. <code>$x^2$</code> with <code>\eqn{x^2}</code>. This should not be needed for versions of Rdpack 0.8-4 or later.</p>
<p>Some Latex macros may have to be removed or replaced with suitable Rd markup. Again, do this only if they cause problems, since some are supported, e.g. <code>\doi</code>.</p>
<p>See also the overview help page, <code><a href="reference/Rdpack-package.html">help("Rdpack-package")</a></code>, of package <code>"Rdpack"</code>. Among other things, it contains some dummy references which illustrate the above.</p>
<p><a id="org5fd3efd"></a></p>
</div>
<div class="section level2">
<h2 id="encoding-of-file-referencesbib">Encoding of file REFERENCES.bib<a class="anchor" aria-label="anchor" href="#encoding-of-file-referencesbib"></a>
</h2>
<p>If a package has a declared encoding (in file <code>DESCRIPTION</code>), <code>REFERENCES.bib</code> is read-in with that encoding<sup><a id="fnr.4" class="footref" href="#fn.4">4</a></sup>. Otherwise, the encoding of <code>REFERENCES.bib</code> is assumed to be UTF-8 (which includes ASCII as a subset).</p>
<p>Note that BibTeX entries downloaded from online databases and similar sources may contain unexpected characters in other encodings, e.g. ‘latin1’. In such cases the check tools in R-devel (since about 2018-10-01) may give warnings like:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>prepare_Rd<span class="op">:</span><span class="st"> </span>input string <span class="dv">1</span> is invalid <span class="cf">in</span> this locale</span></code></pre></div>
<p>To resolve this, convert the file to the declared encoding or UTF-8. Alternatively, replace the offending symbols with their classic TeX/LaTeX equivalents (which are ASCII). Non-ASCII symbols in BibTeX entries obtained from online databases are often in fields like “Abstract”, which are normally not included in lists of references and can be deleted from REFERENCES.bib.</p>
<p>One way to check for non-ASCII symbols in a file is <code><a href="https://rdrr.io/r/tools/showNonASCII.html" class="external-link">tools::showNonASCIIfile()</a></code>.</p>
<p>Internally, LaTeX sequences standing for accented Latin characters, such as <code>\'e</code> and <code>\"o</code>, are converted to UTF-8. So, even if the file REFERENCES.bib is pure ASCII, it may implicitly give raise to non-ASCII characters. This may cause R’s checking tools to complain about non-ASCII characters even after it has been verified that there are none. If this happens, add the encoding declaration to file DESCRIPTION<sup><a id="fnr.5" class="footref" href="#fn.5">5</a></sup>:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>Encoding<span class="op">:</span><span class="st"> </span>UTF<span class="dv">-8</span></span></code></pre></div>
<p>Needless to say, make sure that there are really no characters from encodings like ‘latin1’.</p>
<p><a id="orgb41e139"></a></p>
</div>
</div>
<div class="section level1">
<h1 id="viewing-rd-files">Viewing Rd files<a class="anchor" aria-label="anchor" href="#viewing-rd-files"></a>
</h1>
<p>The function <code><a href="reference/viewRd.html">viewRd()</a></code> can be used to view Rd files in the source directory of a package<sup><a id="fnr.6" class="footref" href="#fn.6">6</a></sup>. A typical user call would look something like:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>Rdpack<span class="op">::</span><span class="kw">viewRd</span>(<span class="st">"./man/filename.Rd"</span>)</span></code></pre></div>
<p>The requested help page is shown in the default format for the current R session (taken from <code>getOption("help_type")</code>). To request a specific format set <code>type</code> to <code>"html"</code> or <code>"text"</code>, as in:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>Rdpack<span class="op">::</span><span class="kw">viewRd</span>(<span class="st">"./man/filename.Rd"</span>, <span class="dt">type =</span> <span class="st">"html"</span>) <span class="co"># open in a browser</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>Rdpack<span class="op">::</span><span class="kw">viewRd</span>(<span class="st">"./man/filename.Rd"</span>, <span class="dt">type =</span> <span class="st">"text"</span>) <span class="co"># text</span></span></code></pre></div>
<p><code><a href="reference/viewRd.html">viewRd()</a></code> renders references and citations correctly, since it processes Rd macros.</p>
<p>Users of ‘devtools’ can use <code>viewRd</code> in place of <code><a href="https://rdrr.io/r/utils/help.html" class="external-link">help()</a></code> to view rendered Rd sources in development mode. This should work also in development mode on any platform (e.g. RStudio, Emacs/ESS, Rgui)<sup><a id="fnr.7" class="footref" href="#fn.7">7</a></sup>.</p>
<p><a id="orgcdf91db"></a></p>
</div>
<div class="section level1">
<h1 id="using-rdpackreprompt">Using Rdpack::reprompt()<a class="anchor" aria-label="anchor" href="#using-rdpackreprompt"></a>
</h1>
<p><a id="orge44c86a"></a></p>
<div class="section level2">
<h2 id="what-it-does">What it does<a class="anchor" aria-label="anchor" href="#what-it-does"></a>
</h2>
<p><code><a href="reference/reprompt.html">Rdpack::reprompt()</a></code> updates <code>Rd</code> documentation. In the most common case when it is called on an <code>Rd</code> file, it updates the documentation of all functions, methods and classes documented in the file. For functions this includes updating the usage section, adding missing aliases and <code>\item</code>’s for arguments not described yet. For methods and classes entries for new methods and slots are updated in a similar way. See the documentation for details.</p>
<p><code><a href="reference/reprompt.html">Rdpack::reprompt()</a></code> can also be invoked on an object or the name of an object, just as <code><a href="https://rdrr.io/r/utils/prompt.html" class="external-link">utils::prompt</a></code>. In that case it checks for installed documentation for the object and works on it if found. Otherwise it creates an <code>Rd</code> file with initial content similar to the one generated by <code><a href="https://rdrr.io/r/utils/prompt.html" class="external-link">utils::prompt</a></code> but modified so that the package can be built.</p>
<p>If a new function, say <code>newfun</code> is to be documented in an existing Rd file, just add <code>newfun()</code> to the usage section in the file and call <code><a href="reference/reprompt.html">Rdpack::reprompt()</a></code> to insert the correct usage statement, add an alias, and add items for any new arguments. Put quotes around the function name if it is non-syntactic. For replacement functions (functions with names ending in <code>&lt;-</code>) <code><a href="reference/reprompt.html">reprompt()</a></code> will insert the proper usage statement. For example, if the signature of <code>xxx&lt;-</code> is <code>(x, ..., value)</code>, then both, <code>"xxx&lt;-"()</code> and <code>xxx() &lt;- value</code> will be replaced by <code>xxx(x, ...) &lt;- value</code>.</p>
<p><code><a href="reference/reprompt.html">Rdpack::reprompt()</a></code> <strong>does not remove</strong> anything that has become obsolete but it alerts the user to remove aliases, methods, and descriptions of arguments that have been removed.</p>
<p><a id="org975854d"></a></p>
</div>
<div class="section level2">
<h2 id="reprompt-and-open-in-an-editor">Reprompt and open in an editor<a class="anchor" aria-label="anchor" href="#reprompt-and-open-in-an-editor"></a>
</h2>
<p>To open the <code><a href="reference/reprompt.html">reprompt()</a></code>-ed file, argument <code>edit</code> can be used. For this to work, <code>options("editor")</code> needs to be set suitably but it usually is. If <code>edit = TRUE</code>, then <code><a href="reference/reprompt.html">Rdpack::reprompt()</a></code> will open the Rd file in an editor. For more convenient access to this feature, use <code><a href="reference/ereprompt.html">Rdpack::ereprompt()</a></code> (edit reprompt), which calls <code><a href="reference/reprompt.html">Rdpack::reprompt()</a></code> with <code>edit = TRUE</code> and sets the output filename to be the same as the input filename.</p>
<p>In RStudio, <code><a href="reference/reprompt.html">reprompt()</a></code> can be invoked on the <code>Rd</code> file being edited or the selected name of an object in a source code file using RStudio add-in <code>Repropmpt</code> (contributed by Duncan Murdoch). Obviously, this makes sense only for Rd files not generated by <code>roxygen2</code>.</p>
<p>In Emacs/ESS there are various ways to use <code><a href="reference/reprompt.html">Rdpack::reprompt()</a></code> and <code><a href="reference/ereprompt.html">Rdpack::ereprompt()</a></code>. If <code>options("editor")</code> is set to <code>emacsclient</code>, <code><a href="reference/ereprompt.html">Rdpack::ereprompt</a></code> is one option. It can also be assigned to a key (wrapped in Elisp code), for example to be invoked on the currently edited file. Such a function and example key binding can be found at <a href="https://github.com/GeoBosh/georgisemacs" class="external-link">georgisemacs</a>.</p>
<p><a id="orgb77362a"></a></p>
</div>
</div>
<div class="section level1">
<h1 id="inserting-evaluated-examples">Inserting evaluated examples<a class="anchor" aria-label="anchor" href="#inserting-evaluated-examples"></a>
</h1>
<p><code>Rdpack</code> provides a macro that takes a chunk of R code, evaluates it, and includes both the code and the results in the rendered documentation. The layout is similar to that in the R console but the code is not prefixed with anything and the output is prefixed with comment symbols. For example,</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>\printExample{<span class="dv">2</span><span class="op">+</span><span class="dv">2</span>; a &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="dv">3</span>; a}</span></code></pre></div>
<p>gives</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="co">##: 4</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>a &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>a</span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="co">##: 6</span></span></code></pre></div>
<p>The help page of <code><a href="reference/promptUsage.html">?Rdpack::promptUsage</a></code> contains a number of examples created with <code>\printExample</code>. The corresponding Rd file can be obtained from the package tarball or from <a href="https://github.com/GeoBosh/Rdpack/blob/master/man/promptUsage.Rd" class="external-link uri">https://github.com/GeoBosh/Rdpack/blob/master/man/promptUsage.Rd</a>.</p>
<p>Vignette <a href="https://github.com/GeoBosh/Rdpack/blob/master/vignettes/Inserting_figures_and_evaluated_examples.pdf" class="external-link"><code>Inserting_figures_and_evaluated_examples</code></a> gives further details.</p>
<p><a id="org3bee793"></a></p>
<div class="section level2">
<h2 id="evaluating-the-examples-in-section-examples">Evaluating the examples in section Examples<a class="anchor" aria-label="anchor" href="#evaluating-the-examples-in-section-examples"></a>
</h2>
<p>The macro <code>\runExamples</code> can be used as a replacement of section <code>examples</code>. For example, if the following code is put at the top level in an Rd file (i.e. not in a section):</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>\runExamples{<span class="dv">2</span><span class="op">+</span><span class="dv">2</span>; a &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="dv">3</span>; a}</span></code></pre></div>
<p>then it will be evaluated and replaced by a normal section examples:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>\examples{</span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="co">##: 4</span></span>
<span id="cb23-4"><a href="#cb23-4"></a>a &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span></span>
<span id="cb23-5"><a href="#cb23-5"></a>a</span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="co">##: 6</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>}</span></code></pre></div>
<p>This generated examples section is processed by the standard R tools (almost) as if it was there from the outset. In particular, the examples are run by the R’s quality control tools and tangled along with examples in other documentation files<sup><a id="fnr.8" class="footref" href="#fn.8">8</a></sup>. A small example package using this feature is at <a href="https://github.com/GeoBosh/reprexes/tree/master/runExamplesCheck" class="external-link">runExamplesCheck</a>.</p>
<p><a id="org9b84bd5"></a></p>
</div>
</div>
<div class="section level1">
<h1 id="inserting-figuresgraphsplots">Inserting figures/graphs/plots<a class="anchor" aria-label="anchor" href="#inserting-figuresgraphsplots"></a>
</h1>
<p>Figures can be inserted with the help of the standard Rd markup command <code>\figure</code>. To generate figures on the fly, package <code>"Rdpack"</code> provides the Rd macro <code>\insertFig</code> which takes a snipped of R code, evaluates it and inserts the plot produced by it (using <code>\figure</code>). <code>\insertFig</code> takes three arguments: a filename, the package name and the code to evaluate to produce the figure. For example,</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>\insertFig{cars.png}{mypackage}{x &lt;-<span class="st"> </span>cars<span class="op">$</span>speed; y &lt;-<span class="st"> </span>cars<span class="op">$</span>dist; <span class="kw">plot</span>(x,y)}</span></code></pre></div>
<p>will evaluate the code, save the graph in file <code>"man/figures/cars.png"</code> subdirectory of package <code>"mypackage"</code>, and include the figure using <code>\figure</code>.</p>
<p>See vignette <a href="https://github.com/GeoBosh/Rdpack/blob/master/vignettes/Inserting_figures_and_evaluated_examples.pdf" class="external-link"><code>Inserting_figures_and_evaluated_examples</code></a> for more details.</p>
</div>
<div class="section level1">
<h1 id="footnotes">Footnotes<a class="anchor" aria-label="anchor" href="#footnotes"></a>
</h1>
<p><sup><a id="fn.1" href="#fnr.1">1</a></sup> From <code>Rdpack (&gt; 2.1.3)</code> (prompted by Martin R. Smith, issue #23).</p>
<p><sup><a id="fn.2" href="#fnr.2">2</a></sup> If you care, here is what happens. These warnings appear because <code>devtools</code> reroutes the help command to process the developer’s Rd sources (rather than the documentation in the installed directory) but doesn’t tell <code>parse_Rd</code> where to look for additional macros. Indeed, the message above shows that the error is in processing a source Rd file in the development directory of the package and that the call to <code>parse_Rd</code> specifies only the file.</p>
<p><sup><a id="fn.3" href="#fnr.3">3</a></sup> Thanks to Michael Dewey for suggesting the discussion of this.</p>
<p><sup><a id="fn.4" href="#fnr.4">4</a></sup> From <code>Rdpack (&gt;=0.9-1)</code> The issue of not handling the encoding was raised by Professor Brian Ripley.</p>
<p><sup><a id="fn.5" href="#fnr.5">5</a></sup> Admittedly, this is not ideal since the user should not need to care how things are processed internally but I haven’t pinpointed the exact cause for this.</p>
<p><sup><a id="fn.6" href="#fnr.6">6</a></sup> From <code>Rdpack (&gt;= 0.4-23)</code>.</p>
<p><sup><a id="fn.7" href="#fnr.7">7</a></sup> In recent versions of Rstudio this function is no longer needed, since <code>?fun</code> now handles the macros.</p>
<p><sup><a id="fn.8" href="#fnr.8">8</a></sup> In versions of <code>R</code> before <code>3.6.0</code> the macro <code>\runExamples</code> may cause <code>R CMD check</code> to give a warning warning about unknown <code>\Sexpr</code> section at top level.</p>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=Rdpack" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/GeoBosh/Rdpack/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/GeoBosh/Rdpack/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing Rdpack</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Georgi N. Boshnakov <br><small class="roles"> Author, maintainer </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=Rdpack" class="external-link"><img src="http://www.r-pkg.org/badges/version/Rdpack" alt="CRANStatusBadge"></a></li>
<li><a href="https://www.r-pkg.org/pkg/Rdpack" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/Rdpack" alt="CRAN RStudio mirror downloads"></a></li>
<li><a href="https://r-pkg.org/pkg/Rdpack" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/Rdpack?color=blue" alt="CRAN RStudio mirror downloads"></a></li>
<li><a href="https://github.com/GeoBosh/Rdpack/actions" class="external-link"><img src="https://github.com/GeoBosh/Rdpack/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/100482670" class="external-link"><img src="https://zenodo.org/badge/100482670.svg" alt="DOI"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Georgi N. Boshnakov.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
